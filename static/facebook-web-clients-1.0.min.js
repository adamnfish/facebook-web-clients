ensurePackage("guardian.ui"),ensurePackage("guardian.facebook"),function(e){function t(t){this.jContainer=e(t),this.initialise()}t.prototype.jContainer=null,t.prototype.paper=null,t.prototype.initialise=function(){var e=this.jContainer.width(),t=this.jContainer.height(),n=e/2,r=t/2,i=(Math.min(e,t)-24)/2;this.paper=new window.Raphael(this.jContainer[0],e,t),this.paper.customAttributes.notch=function(t){var i=3.6*t,s=(90-i)*Math.PI/180,o=e*Math.cos(s),u=e*Math.sin(s),a;return a=[["M",n,r],["l",o,-u]],{path:a}},this.paper.customAttributes.arc=function(e){var t=3.6*e,s=(90-t)*Math.PI/180,o=n+i*Math.cos(s),u=r-i*Math.sin(s),a;return e==100?a=[["M",n,r-i],["A",i,i,0,1,1,n-.01,n-i]]:a=[["M",n,r-i],["A",i,i,0,+(t>180),1,o,u]],{path:a}},this.paper.customAttributes.turn=function(e,t){var r=3.6*e,i=t-r/2;return{transform:["R"+i,n,n].join()}}},t.prototype.render=function(e){e===undefined&&(e=50),this.paper.clear(),this.paper.path().attr(t.NEGATIVE).attr({arc:[100]});var n=this.paper.path().attr(t.POSITIVE).attr({arc:[50]}).animate({arc:[e]},500,"ease-in-out"),r=this.paper.path().attr(t.NOTCH).attr({notch:[0]}),i=this.paper.path().attr(t.NOTCH).attr({notch:[50]}).animate({notch:[e]},500,"ease-in-out");this.paper.set().push(n,r,i).attr({turn:[50,t.LEFT_ANGLE]}).animate({turn:[e,t.LEFT_ANGLE]},500,"ease-in-out")},t.LEFT_ANGLE=270,t.RIGHT_ANGLE=90,t.POSITIVE={stroke:"#3A7D00","stroke-width":18},t.NEGATIVE={stroke:"#0D3D00","stroke-width":18},t.NOTCH={stroke:"#fff","stroke-width":5},guardian.ui.Donut=t}(window.jQuery),function(){function e(){this.agree=0,this.disagree=0}guardian.facebook.VoteModel=e}(),function(){function e(e,t){this.jContainer=jQuery(e),this.model=t,this.initialise()}e.prototype.jContainer=null,e.prototype.donut=null,e.prototype.model=null,e.prototype.initialise=function(){this.donut=new guardian.ui.Donut(this.jContainer.find(".donutContainer")),this.jContainer.delegate(".btn","click.voteComponent",this.handleButtonClick.bind(this)),this.jContainer.find("[data-action='agree'] .count").html(this.model.agree),this.jContainer.find("[data-action='disagree'] .count").html(this.model.disagree)},e.prototype.render=function(){this.donut.render()},e.prototype.handleButtonClick=function(e){var t=jQuery(e.currentTarget),n=t.data("action");this.jContainer.find(".btn").removeClass("btn")},e.prototype.destroy=function(){this.jContainer.undelegate(".voteComponent")},guardian.facebook.VoteComponent=e}();